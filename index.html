<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="utf-8">
  <title>DARMOWE TV NA VLC PLAYER</title>
  <link href="https://vjs.zencdn.net/8.10.0/video-js.css" rel="stylesheet" />
  <style>
    body {background:#000;color:#fff;font-family:Arial;margin:0;padding:20px;text-align:center;}
    h1 {font-size:36px;margin:30px 0;}
    .download a {color:#0ff;font-size:22px;font-weight:bold;text-decoration:none;}
    .channels {display:flex;flex-wrap:wrap;gap:15px;justify-content:center;margin:40px 0;}
    .channel button {background:#222;color:#fff;padding:18px 25px;border:none;cursor:pointer;font-size:17px;min-width:220px;}
    .channel button:hover {background:#444;}
    #player {margin:40px auto;width:90%;max-width:1000px;background:#000;display:block !important;}
    .extra button {background:#0a0;color:#000;padding:20px 40px;font-size:22px;border:none;cursor:pointer;margin:40px;}
    .extra button:hover {background:#0f0;}
  </style>
</head>
<body>

  <h1>DARMOWE TV NA VLC PLAYER</h1>
  <div class="download">
    <a href="https://security.freefreaks.top/playlist.m3u" download="playlist.m3u">POBIERZ PLIK M3U</a>
  </div>

  <div class="channels" id="list">Ładowanie kanałów...</div>

  <!-- Jeden wspólny player -->
  <video id="player" class="video-js vjs-default-skin" controls width="1000" height="560"></video>

  <!-- HISTORY -->
  <div class="extra">
    <button onclick="play('https://d34cf28x8b3d.rocketcdn.me/history.m3u8')">ODTWÓRZ HISTORY</button>
  </div>

  <script src="https://vjs.zencdn.net/8.10.0/video.min.js"></script>
  <script>
    const player = videojs('player', {fluid: true});

    fetch('https://security.freefreaks.top/playlist.m3u?t=' + Date.now())
      .then(r => r.text())
      .then(text => {
        const lines = text.split('\n');
        const container = document.getElementById('list');
        container.innerHTML = '';
        let name = 'Kanał';

        lines.forEach(line => {
          line = line.trim();
          if (line.startsWith('#EXTINF:')) {
            name = line.includes('tvg-name="') ? line.split('tvg-name="')[1].split('"')[0] : line.split(',').pop();
          } else if (line && line.includes('.m3u8')) {
            const btn = document.createElement('div');
            btn.className = 'channel';
            btn.innerHTML = `<button onclick="play('${line}')">${name}</button>`;
            container.appendChild(btn);
          }
        });
      });

    function play(url) {
      player.src({type: 'application/x-mpegURL', src: url});
      player.ready(() => player.play());
      player.el_.scrollIntoView({behavior: 'smooth'});
    }

    // Auto odświeżanie co 4h
    setInterval(() => location.reload(), 14400000);
  </script>
</body>
</html>
