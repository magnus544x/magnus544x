<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="utf-8">
  <title>Moje Kana≈Çy TV</title>
  <link href="https://vjs.zencdn.net/8.10.0/video-js.css" rel="stylesheet" />
  <style>
    body {background:#000;color:#fff;font-family:Arial;margin:0;padding:20px;text-align:center;}
    h1 {margin-bottom:20px;}
    #channels {
      display:inline-block;
      background:#111;
      padding:15px;
      border:1px solid #444;
      max-height:600px;
      overflow-y:auto;
      text-align:left;
      min-width:300px;
    }
    #channels button {
      display:block;
      width:100%;
      padding:12px;
      margin:5px 0;
      background:#222;
      border:none;
      color:#fff;
      cursor:pointer;
      font-size:15px;
    }
    #channels button:hover {background:#444;}
    .container {display:flex;flex-wrap:wrap;gap:20px;justify-content:center;align-items:flex-start;}
    video {max-width:100%;}
  </style>
</head>
<body>
  <h1>Moje Kana≈Çy TV</h1>
  <div class="container">
    <div id="channels">≈Åadowanie kana≈Ç√≥w...</div>
    <video id="player" class="video-js vjs-default-skin" controls preload="auto" width="900" height="506"></video>
  </div>

  <script src="https://vjs.zencdn.net/8.10.0/video.min.js"></script>
  <script>
    const proxy = 'https://corsproxy.io/?';
    const m3uUrl = proxy + encodeURIComponent('https://security.freefreaks.top/playlist.m3u');
    let player = videojs('player', {fluid: true});

    function loadPlaylist() {
      document.getElementById('channels').innerHTML = '<button onclick="loadPlaylist()">üîÑ Od≈õwie≈º listƒô</button><br><br>≈Åadowanie...';
      fetch(m3uUrl + '&t=' + Date.now())
        .then(r => r.text())
        .then(text => {
          const lines = text.split('\n');
          const div = document.getElementById('channels');
          div.innerHTML = '<button onclick="loadPlaylist()">üîÑ Od≈õwie≈º listƒô</button><br><br>';
          let name = 'Nieznany';
          let count = 0;

          for (let line of lines) {
            line = line.trim();
            if (line.startsWith('#EXTINF:')) {
              const match = line.match(/tvg-name="([^"]+)"/);
              name = match ? match[1] : line.split(',').pop();
            } else if (line && line.includes('.m3u8')) {
              const btn = document.createElement('button');
              btn.textContent = name;
              btn.onclick = () => {
                player.src({src: line, type: 'application/x-mpegURL'});
                player.ready(() => player.play());
              };
              div.appendChild(btn);
              count++;
            }
          }
          if (count === 0) div.innerHTML += '<p>Brak kana≈Ç√≥w ‚Äì spr√≥buj p√≥≈∫niej.</p>';
        })
        .catch(err => {
          document.getElementById('channels').innerHTML += '<p style="color:red;">B≈ÇƒÖd: ' + err + '</p>';
        });
    }

    loadPlaylist();
    setInterval(loadPlaylist, 4 * 60 * 60 * 1000); // co 4 godziny
  </script>
</body>
</html>
