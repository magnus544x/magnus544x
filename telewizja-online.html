<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="utf-8">
  <title>MEGA TEST IPTV 2025 – 6 PLAYERÓW + 150+ KANAŁÓW</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <style>
    body {background:#000;color:#fff;font-family:Arial;margin:0;padding:20px;}
    h1 {text-align:center;color:#0f0;font-size:40px;margin:30px 0;}
    .channel {margin:40px 0;background:#111;padding:20px;border-radius:15px;}
    .channel h2 {color:#ff2d95;font-size:26px;margin:0 0 20px;text-align:center;}
    .players {display:grid;grid-template-columns:repeat(auto-fit,minmax(500px,1fr));gap:20px;}
    .player-box {background:#222;padding:15px;border-radius:10px;text-align:center;}
    .player-box h3 {color:#00ff9d;margin:0 0 10px;}
    video, div[id^="jw"], div[id^="flus"] {width:100%;height:400px;background:#000;border-radius:8px;}
    .status {margin-top:10px;font-size:16px;}
    .ok {color:#0f0;}
    .fail {color:#f00;}
  </style>
</head>
<body>

<h1>MEGA TEST IPTV – 6 PLAYERÓW NA RAZ</h1>
<p style="text-align:center;font-size:22px;">Twoja playlista z GitHub – każdy kanał testowany na 6 playerach</p>
<a href="index.html" style="display:block;text-align:center;color:#0ff;font-size:20px;margin:20px;">← Powrót do strony głównej</a>

<div id="test"></div>

<script src="https://cdn.jwplayer.com/libraries/IDzF9Zmk.js"></script>
<script src="https://flussonic.com/public/player/v2/player.js"></script>
<script src="https://vjs.zencdn.net/8.10.0/video.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/hls.js@1.5.15"></script>
<script src="https://cdn.plyr.io/3.7.8/plyr.js"></script>

<script>
  fetch('playlist.m3u?' + Date.now())
    .then(r => r.text())
    .then(text => {
      const lines = text.split('\n');
      const container = document.getElementById('test');
      let url = '';
      let name = 'Kanał';
      let count = 0;

      lines.forEach(line => {
        line = line.trim();
        if (line.startsWith('#EXTINF:')) {
          const m = line.match(/tvg-name="([^"]+)"/) || line.match(/,(.+)$/);
          name = m ? m[1].trim() : 'Kanał';
        } else if (line && line.includes('.m3u8')) {
          count++;
          url = line.startsWith('http') ? line : 'https://security.freefreaks.top/' + line;

          const div = document.createElement('div');
          div.className = 'channel';
          div.innerHTML = `
            <h2>${count}. ${name}</h2>
            <div class="players">
              <div class="player-box"><h3>JW Player</h3><div id="jw${count}"></div><div class="status" id="s1${count}">Ładowanie...</div></div>
              <div class="player-box"><h3>Flussonic</h3><div id="flus${count}"></div><div class="status" id="s2${count}">Ładowanie...</div></div>
              <div class="player-box"><h3>Video.js</h3><video id="vjs${count}" class="video-js"></video><div class="status" id="s3${count}">Ładowanie...</div></div>
              <div class="player-box"><h3>Plyr</h3><video id="plyr${count}"></video><div class="status" id="s4${count}">Ładowanie...</div></div>
              <div class="player-box"><h3>HLS.js</h3><video id="hls${count}" controls></video><div class="status" id="s5${count}">Ładowanie...</div></div>
              <div class="player-box"><h3>HTML5</h3><video id="html${count}" controls></video><div class="status" id="s6${count}">Ładowanie...</div></div>
            </div>
          `;
          container.appendChild(div);

          // 1. JW Player
          try { jwplayer(`jw${count}`).setup({file: url, width: "100%", height: "100%", autostart: true}); document.getElementById(`s1${count}`).innerHTML = '<span class="ok">DZIAŁA</span>'; } catch(e) { document.getElementById(`s1${count}`).innerHTML = '<span class="fail">Błąd</span>'; }

          // 2. Flussonic
          try { new FlussonicPlayer(`#flus${count}`, {url: url, autoplay: true}); document.getElementById(`s2${count}`).innerHTML = '<span class="ok">DZIAŁA</span>'; } catch(e) { document.getElementById(`s2${count}`).innerHTML = '<span class="fail">Błąd</span>'; }

          // 3. Video.js
          try { const v = videojs(`vjs${count}`, {fluid: true}); if (Hls.isSupported()) { new Hls().loadSource(url); new Hls().attachMedia(v.tech_.el_); } document.getElementById(`s3${count}`).innerHTML = '<span class="ok">DZIAŁA</span>'; } catch(e) { document.getElementById(`s3${count}`).innerHTML = '<span class="fail">Błąd</span>'; }

          // 4. Plyr
          try { new Plyr(`#plyr${count}`, {autoplay: true}); if (Hls.isSupported()) { new Hls().loadSource(url); new Hls().attachMedia(document.getElementById(`plyr${count}`)); } document.getElementById(`s4${count}`).innerHTML = '<span class="ok">DZIAŁA</span>'; } catch(e) { document.getElementById(`s4${count}`).innerHTML = '<span class="fail">Błąd</span>'; }

          // 5. HLS.js
          try { const video = document.getElementById(`hls${count}`); if (Hls.isSupported()) { new Hls().loadSource(url); new Hls().attachMedia(video); } document.getElementById(`s5${count}`).innerHTML = '<span class="ok">DZIAŁA</span>'; } catch(e) { document.getElementById(`s5${count}`).innerHTML = '<span class="fail">Błąd</span>'; }

          // 6. HTML5
          try { document.getElementById(`html${count}`).src = url; document.getElementById(`s6${count}`).innerHTML = '<span class="ok">DZIAŁA (jeśli widzisz obraz)</span>'; } catch(e) { document.getElementById(`s6${count}`).innerHTML = '<span class="fail">Błąd</span>'; }
        }
      });
    });
</script>

</body>
</html>
